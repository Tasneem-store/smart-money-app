<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#667eea">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø§Ù„ Ø§Ù„Ø°ÙƒÙŠ - Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Cairo', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: #333;
            line-height: 1.6;
            padding: 15px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.98);
            border-radius: 12px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
            padding: 20px;
            backdrop-filter: blur(5px);
        }
        
        header {
            text-align: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e0e6ff;
        }
        
        h1 {
            color: #4a5568;
            font-size: 1.8rem;
            margin-bottom: 8px;
            font-weight: 700;
        }
        
        .subtitle {
            color: #718096;
            font-size: 0.9rem;
        }
        
        .summary-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(170px, 1fr));
            gap: 12px;
            margin-bottom: 20px;
        }
        
        .card {
            background: linear-gradient(135deg, #ffffff 0%, #f8f9ff 100%);
            border-radius: 10px;
            padding: 18px;
            text-align: center;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
            transition: transform 0.3s ease;
            border: 1px solid #e2e8f0;
        }
        
        .card:hover {
            transform: translateY(-2px);
        }
        
        .income-card {
            border-top: 3px solid #38a169;
        }
        
        .expense-card {
            border-top: 3px solid #e53e3e;
        }
        
        .balance-card {
            border-top: 3px solid #4c51bf;
        }
        
        .card h3 {
            font-size: 0.95rem;
            margin-bottom: 10px;
            color: #4a5568;
            font-weight: 600;
        }
        
        .amount {
            font-size: 1.4rem;
            font-weight: bold;
        }
        
        .income-amount {
            color: #38a169;
        }
        
        .expense-amount {
            color: #e53e3e;
        }
        
        .balance-amount {
            color: #4c51bf;
        }
        
        .input-section {
            background: linear-gradient(135deg, #ffffff 0%, #f8f9ff 100%);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
            border: 1px solid #e2e8f0;
        }
        
        .section-title {
            font-size: 1.1rem;
            color: #4a5568;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid #e2e8f0;
            font-weight: 600;
        }
        
        .input-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        @media (max-width: 768px) {
            .input-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .form-group {
            margin-bottom: 12px;
        }
        
        label {
            display: block;
            margin-bottom: 6px;
            color: #4a5568;
            font-weight: 600;
            font-size: 0.85rem;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 9px 11px;
            border: 1px solid #cbd5e0;
            border-radius: 7px;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            background: white;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #4c51bf;
            box-shadow: 0 0 0 3px rgba(76, 81, 191, 0.1);
        }
        
        .btn {
            background: linear-gradient(to right, #4c51bf, #667eea);
            color: white;
            border: none;
            padding: 10px 16px;
            border-radius: 7px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            box-shadow: 0 3px 10px rgba(76, 81, 191, 0.2);
        }
        
        .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 5px 12px rgba(76, 81, 191, 0.3);
        }
        
        .btn-voice {
            background: linear-gradient(to right, #ed64a6, #ed8936);
            font-size: 1rem;
            padding: 12px 20px;
            height: 55px;
        }
        
        .btn-voice .icon {
            font-size: 1.3rem;
        }
        
        .buttons {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 12px;
            margin-top: 8px;
        }
        
        .voice-status {
            margin-top: 12px;
            padding: 10px;
            border-radius: 7px;
            text-align: center;
            display: none;
            background: #ebf8ff;
            color: #2c5282;
            border: 1px solid #bee3f8;
            font-size: 0.85rem;
        }
        
        .voice-listening {
            display: block;
        }
        
        .records-section, .report-section {
            background: linear-gradient(135deg, #ffffff 0%, #f8f9ff 100%);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
            border: 1px solid #e2e8f0;
        }
        
        .filter-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 12px;
            margin-bottom: 15px;
        }
        
        #recordsList {
            max-height: 350px;
            overflow-y: auto;
            border: 1px solid #e2e8f0;
            border-radius: 7px;
            background: white;
        }
        
        .record-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 12px;
            border-bottom: 1px solid #edf2f7;
            transition: background 0.2s ease;
            font-size: 0.85rem;
        }
        
        .record-item:hover {
            background: #f7fafc;
        }
        
        .record-item:last-child {
            border-bottom: none;
        }
        
        .record-info {
            display: flex;
            flex-direction: column;
            gap: 3px;
            flex-grow: 1;
        }
        
        .record-header {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .type-income {
            background: #c6f6d5;
            color: #22543d;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 600;
        }
        
        .type-expense {
            background: #fed7d7;
            color: #742a2a;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 600;
        }
        
        .record-category {
            color: #4a5568;
            font-size: 0.85rem;
            font-weight: 500;
        }
        
        .record-date {
            color: #a0aec0;
            font-size: 0.75rem;
        }
        
        .record-amount {
            font-size: 1rem;
            font-weight: bold;
        }
        
        .record-income {
            color: #38a169;
        }
        
        .record-expense {
            color: #e53e3e;
        }
        
        .record-actions {
            display: flex;
            gap: 6px;
        }
        
        .btn-delete {
            background: #fc8181;
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.75rem;
            transition: background 0.3s ease;
        }
        
        .btn-delete:hover {
            background: #f56565;
        }
        
        .empty-message {
            text-align: center;
            color: #a0aec0;
            padding: 30px 15px;
            font-style: italic;
            font-size: 0.9rem;
        }
        
        /* Ù‚Ø³Ù… Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± */
        .report-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 12px;
            margin-bottom: 20px;
        }
        
        .report-table-container {
            overflow-x: auto;
            border: 1px solid #e2e8f0;
            border-radius: 7px;
            background: white;
            max-height: 400px;
            overflow-y: auto;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.85rem;
        }
        
        th, td {
            padding: 10px 12px;
            text-align: right;
            border-bottom: 1px solid #e2e8f0;
        }
        
        th {
            background: #f7fafc;
            color: #4a5568;
            font-weight: 600;
            font-size: 0.85rem;
            position: sticky;
            top: 0;
        }
        
        tr:hover {
            background: #f7fafc;
        }
        
        .category-header {
            background: #ebf8ff;
            color: #2c5282;
            font-weight: 600;
            font-size: 0.9rem;
        }
        
        .total-row {
            background: #f7fafc;
            font-weight: bold;
            color: #2d3748;
            position: sticky;
            bottom: 0;
        }
        
        .no-data {
            text-align: center;
            padding: 25px;
            color: #a0aec0;
            font-style: italic;
            font-size: 0.9rem;
        }
        
        .btn-generate {
            background: linear-gradient(to right, #38a169, #48bb78);
            height: 40px;
        }
        
        .btn-clear {
            background: linear-gradient(to right, #e53e3e, #f56565);
            height: 40px;
        }
        
        .btn-add-category {
            background: linear-gradient(to right, #805ad5, #6b46c1);
            margin-top: 8px;
            width: 100%;
        }
        
        .category-manager {
            margin-top: 15px;
            padding: 15px;
            background: #f7fafc;
            border-radius: 7px;
            border: 1px solid #e2e8f0;
        }
        
        .categories-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 10px;
        }
        
        .category-tag {
            background: #e2e8f0;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .category-tag-remove {
            background: #fc8181;
            color: white;
            border: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 0.7rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .category-tag-remove:hover {
            background: #f56565;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 12px;
            }
            
            .summary-cards {
                grid-template-columns: 1fr;
            }
            
            .buttons {
                grid-template-columns: 1fr;
            }
            
            .btn-voice {
                height: 50px;
            }
            
            .record-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 6px;
                font-size: 0.8rem;
            }
            
            .record-amount {
                align-self: flex-end;
            }
            
            th, td {
                padding: 8px 10px;
                font-size: 0.8rem;
            }
            
            .section-title {
                font-size: 1rem;
            }
        }
        
        .loading {
            display: none;
            text-align: center;
            padding: 15px;
            color: #4c51bf;
            font-size: 0.9rem;
        }
        
        .loading.active {
            display: block;
        }
        
        .statistics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 12px;
            margin-top: 15px;
            padding: 12px;
            background: #f7fafc;
            border-radius: 7px;
            border: 1px solid #e2e8f0;
            font-size: 0.85rem;
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-value {
            font-size: 1.2rem;
            font-weight: bold;
            color: #4c51bf;
        }
        
        .stat-label {
            font-size: 0.8rem;
            color: #718096;
        }
        
        .voice-instructions {
            font-size: 0.8rem;
            color: #718096;
            margin-top: 8px;
            padding: 8px;
            background: #f7fafc;
            border-radius: 7px;
            border: 1px solid #e2e8f0;
        }
        
        .voice-instructions p {
            margin: 4px 0;
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <header>
            <h1>Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø§Ù„ Ø§Ù„Ø°ÙƒÙŠ ğŸ’°</h1>
            <p class="subtitle">ØªØ·Ø¨ÙŠÙ‚ Ù…ØªÙƒØ§Ù…Ù„ Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¯Ø®Ù„ ÙˆØ§Ù„Ù…ØµØ±ÙˆÙØ§Øª Ù…Ø¹ ØªÙ‚Ø§Ø±ÙŠØ± Ù…ÙØµÙ„Ø©</p>
        </header>
        
        <div class="summary-cards">
            <div class="card income-card">
                <h3>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¯Ø®Ù„</h3>
                <div class="amount income-amount" id="income">0</div>
            </div>
            
            <div class="card expense-card">
                <h3>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª</h3>
                <div class="amount expense-amount" id="expense">0</div>
            </div>
            
            <div class="card balance-card">
                <h3>Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ</h3>
                <div class="amount balance-amount" id="balance">0</div>
            </div>
        </div>
        
        <div class="input-section">
            <h2 class="section-title">Ø¥Ø¶Ø§ÙØ© Ø¹Ù…Ù„ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©</h2>
            
            <div class="input-grid">
                <div>
                    <form id="manualForm">
                        <div class="form-group">
                            <label for="amountInput">Ø§Ù„Ù…Ø¨Ù„Øº</label>
                            <input type="number" id="amountInput" step="0.01" min="0.01" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="typeInput">Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©</label>
                            <select id="typeInput" required>
                                <option value="income">Ø¯Ø®Ù„</option>
                                <option value="expense">Ù…ØµØ±ÙˆÙ</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="categoryInput">Ø§Ù„ØªØµÙ†ÙŠÙ</label>
                            <div style="display: flex; gap: 8px;">
                                <select id="categoryInput" style="flex: 1;">
                                    <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¨Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ© -->
                                </select>
                                <input type="text" id="newCategoryInput" placeholder="ØªØµÙ†ÙŠÙ Ø¬Ø¯ÙŠØ¯" style="flex: 1;">
                            </div>
                            <button type="button" id="addCategoryBtn" class="btn btn-add-category">
                                <span>â•</span> Ø¥Ø¶Ø§ÙØ© ØªØµÙ†ÙŠÙ Ø¬Ø¯ÙŠØ¯
                            </button>
                        </div>
                        
                        <div class="buttons">
                            <button type="submit" class="btn">
                                <span>ğŸ’¾</span> Ø­ÙØ¸ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©
                            </button>
                        </div>
                    </form>
                    
                    <div class="category-manager">
                        <label>Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©:</label>
                        <div id="categoriesList" class="categories-list">
                            <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¨Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª -->
                        </div>
                    </div>
                </div>
                
                <div>
                    <div class="form-group">
                        <label>Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„ØµÙˆØªÙŠ</label>
                        <button type="button" id="voiceBtn" class="btn btn-voice">
                            <span class="icon">ğŸ¤</span> Ø§Ø¶ØºØ· Ù„Ù„ØªØ­Ø¯Ø« ÙˆØ¥Ø¶Ø§ÙØ© Ø¹Ù…Ù„ÙŠØ©
                        </button>
                    </div>
                    
                    <div id="voiceStatus" class="voice-status">
                        Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹... ØªØ­Ø¯Ø« Ø§Ù„Ø¢Ù†
                    </div>
                    
                    <div class="voice-instructions">
                        <p><strong>ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„Ø£ÙˆØ§Ù…Ø± Ø§Ù„ØµÙˆØªÙŠØ©:</strong></p>
                        <p>ğŸ”¹ "Ø¯Ø®Ù„ Ù¡Ù Ù Ù  Ø±Ø§ØªØ¨"</p>
                        <p>ğŸ”¹ "Ù…ØµØ±ÙˆÙ Ù¢Ù Ù  Ø£ÙƒÙ„"</p>
                        <p>ğŸ”¹ "Ù…ØµØ±ÙˆÙ Ù¡Ù¥Ù  Ù…ÙˆØ§ØµÙ„Ø§Øª"</p>
                        <p>ğŸ”¹ "Ù…ØµØ±ÙˆÙ Ø®Ù…Ø³Ø© Ø¢Ù„Ø§Ù Ø¥ÙŠØ¬Ø§Ø±"</p>
                        <p>ğŸ”¹ "Ù…ØµØ±ÙˆÙ Ø¹Ø´Ø±ÙŠÙ† Ø£Ù„Ù Ø³ÙØ±"</p>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="records-section">
            <h2 class="section-title">Ø³Ø¬Ù„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª</h2>
            
            <div class="filter-section">
                <div class="form-group">
                    <label for="filterDateFrom">Ù…Ù† ØªØ§Ø±ÙŠØ®</label>
                    <input type="date" id="filterDateFrom">
                </div>
                
                <div class="form-group">
                    <label for="filterDateTo">Ø¥Ù„Ù‰ ØªØ§Ø±ÙŠØ®</label>
                    <input type="date" id="filterDateTo">
                </div>
                
                <div class="form-group">
                    <label for="filterCategory">Ø§Ù„ØªØµÙ†ÙŠÙ</label>
                    <select id="filterCategory">
                        <option value="all">Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª</option>
                        <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¨Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª -->
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</label>
                    <div style="display: flex; gap: 8px;">
                        <button id="filterBtn" class="btn" style="flex: 1;">ğŸ” ØªØ·Ø¨ÙŠÙ‚</button>
                        <button id="clearFilterBtn" class="btn" style="background: linear-gradient(to right, #a0aec0, #cbd5e0); flex: 1;">ğŸ—‘ï¸ Ù…Ø³Ø­</button>
                    </div>
                </div>
            </div>
            
            <div id="recordsList" class="empty-message">
                Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù…Ù„ÙŠØ§Øª Ù…Ø³Ø¬Ù„Ø© Ø¨Ø¹Ø¯. Ø£Ø¶Ù Ø£ÙˆÙ„ Ø¹Ù…Ù„ÙŠØ©!
            </div>
        </div>
        
        <div class="report-section">
            <h2 class="section-title">ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª Ø­Ø³Ø¨ Ø§Ù„ØªØµÙ†ÙŠÙ</h2>
            
            <div class="report-controls">
                <div class="form-group">
                    <label for="reportDateFrom">Ù…Ù† ØªØ§Ø±ÙŠØ®</label>
                    <input type="date" id="reportDateFrom">
                </div>
                
                <div class="form-group">
                    <label for="reportDateTo">Ø¥Ù„Ù‰ ØªØ§Ø±ÙŠØ®</label>
                    <input type="date" id="reportDateTo">
                </div>
                
                <div class="form-group">
                    <label>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</label>
                    <div style="display: flex; gap: 8px;">
                        <button id="generateReportBtn" class="btn btn-generate" style="flex: 2;">ğŸ“Š Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªÙ‚Ø±ÙŠØ±</button>
                        <button id="clearReportBtn" class="btn btn-clear" style="flex: 1;">ğŸ—‘ï¸ Ù…Ø³Ø­</button>
                    </div>
                </div>
            </div>
            
            <div class="loading" id="reportLoading">
                Ø¬Ø§Ø±ÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªÙ‚Ø±ÙŠØ±...
            </div>
            
            <div id="reportTableContainer" class="report-table-container">
                <div class="no-data" id="reportNoData">
                    Ù‚Ù… Ø¨ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ø²Ù…Ù†ÙŠØ© ÙˆØ¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªÙ‚Ø±ÙŠØ±
                </div>
                <table id="reportTable" style="display: none;">
                    <thead>
                        <tr>
                            <th width="35%">Ø§Ù„ØªØµÙ†ÙŠÙ</th>
                            <th width="30%">Ø§Ù„Ù…Ø¨Ù„Øº</th>
                            <th width="35%">Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                        </tr>
                    </thead>
                    <tbody id="reportTableBody">
                        <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¨Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª -->
                    </tbody>
                    <tfoot id="reportTableFooter">
                        <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¨Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ -->
                    </tfoot>
                </table>
            </div>
            
            <div class="statistics" id="reportStatistics" style="display: none;">
                <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¨Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª -->
            </div>
        </div>
    </div>

    <script>
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Acode Ù…Ø¹ Ø¥Ø¶Ø§ÙØ© fallback Ù„Ù€ localStorage
        let useLocalStorage = false;
        if (!window.acode) {
            console.log("Ø¨ÙŠØ¦Ø© Acode ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø©ØŒ Ø³ÙŠØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… localStorage");
            useLocalStorage = true;
            
            // Ù…Ø­Ø§ÙƒØ§Ø© acode.fs API Ù„Ù€ localStorage
            window.acode = {
                fs: {
                    async readFile(fileName) {
                        return localStorage.getItem(fileName) || '[]';
                    },
                    async writeFile(fileName, content) {
                        localStorage.setItem(fileName, content);
                        return true;
                    }
                }
            };
        }

        // Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ù…Ù„ÙØ§Øª
        const recordsFileName = "smart_money_records.json";
        const categoriesFileName = "smart_money_categories.json";

        // Ù…ØµÙÙˆÙØ© Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª ÙˆØ§Ù„ØªØµÙ†ÙŠÙØ§Øª
        let records = [];
        let categories = ["Ø±ÙˆØ§ØªØ¨", "Ø£ÙƒÙ„ ÙˆÙ…Ø´Ø±ÙˆØ¨Ø§Øª", "Ù…ÙˆØ§ØµÙ„Ø§Øª", "ØªØ³ÙˆÙ‚", "ØªØ±ÙÙŠÙ‡", "ØµØ­Ø©", "Ù…Ù†Ø²Ù„", "ØªØ¹Ù„ÙŠÙ…", "Ø§Ø³ØªØ«Ù…Ø§Ø±", "Ù‡Ø¯Ø§ÙŠØ§ ÙˆØªØ¨Ø±Ø¹Ø§Øª", "ÙÙˆØ§ØªÙŠØ±", "Ø£Ø®Ø±Ù‰"];

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ù…Ù„ÙØ§Øª Ø¹Ù†Ø¯ Ø¨Ø¯Ø¡ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        async function loadData() {
            try {
                // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³Ø¬Ù„Ø§Øª
                const recordsFile = await acode.fs.readFile(recordsFileName);
                records = JSON.parse(recordsFile);
                if (!Array.isArray(records)) {
                    console.log("Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ù„ÙŠØ³Øª Ù…ØµÙÙˆÙØ©ØŒ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†");
                    records = [];
                }
            } catch (err) {
                console.log("Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù Ø¬Ø¯ÙŠØ¯ Ù„Ù„Ø³Ø¬Ù„Ø§Øª");
                records = [];
            }
            
            try {
                // ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª
                const categoriesFile = await acode.fs.readFile(categoriesFileName);
                const loadedCategories = JSON.parse(categoriesFile);
                if (Array.isArray(loadedCategories) && loadedCategories.length > 0) {
                    categories = loadedCategories;
                }
            } catch (err) {
                console.log("Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©");
                // Ø­ÙØ¸ Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
                await acode.fs.writeFile(categoriesFileName, JSON.stringify(categories));
            }
            
            // ØªØ¹ÙŠÙŠÙ† Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø§Ù„ÙŠ ÙƒÙ‚ÙŠÙ…Ø© Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ù„Ù„Ù…Ø±Ø§ÙˆÙŠØ­
            const today = new Date().toISOString().split('T')[0];
            const weekAgo = new Date();
            weekAgo.setDate(weekAgo.getDate() - 7);
            const weekAgoStr = weekAgo.toISOString().split('T')[0];
            
            document.getElementById('filterDateFrom').value = weekAgoStr;
            document.getElementById('filterDateTo').value = today;
            document.getElementById('reportDateFrom').value = weekAgoStr;
            document.getElementById('reportDateTo').value = today;
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
            updateCategoriesUI();
            updateSummary();
            updateRecordsList();
        }

        // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        async function saveRecords() {
            try {
                await acode.fs.writeFile(recordsFileName, JSON.stringify(records));
                console.log("ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ø¨Ù†Ø¬Ø§Ø­");
            } catch (err) {
                console.error("Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø³Ø¬Ù„Ø§Øª:", err);
                showNotification("Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");
            }
        }

        async function saveCategories() {
            try {
                await acode.fs.writeFile(categoriesFileName, JSON.stringify(categories));
                console.log("ØªÙ… Ø­ÙØ¸ Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª Ø¨Ù†Ø¬Ø§Ø­");
            } catch (err) {
                console.error("Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª:", err);
            }
        }

        // ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶ Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª ÙÙŠ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
        function updateCategoriesUI() {
            const categorySelect = document.getElementById('categoryInput');
            const filterCategorySelect = document.getElementById('filterCategory');
            const categoriesListDiv = document.getElementById('categoriesList');
            
            // ØªÙØ±ÙŠØº Ø§Ù„Ù‚ÙˆØ§Ø¦Ù…
            categorySelect.innerHTML = '';
            filterCategorySelect.innerHTML = '<option value="all">Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª</option>';
            categoriesListDiv.innerHTML = '';
            
            // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª Ø¥Ù„Ù‰ Ø§Ù„Ù‚ÙˆØ§Ø¦Ù…
            categories.forEach(category => {
                // Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„
                const option = document.createElement('option');
                option.value = category;
                option.textContent = category;
                categorySelect.appendChild(option);
                
                // Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª Ù„Ù„ØªØµÙÙŠØ©
                const filterOption = document.createElement('option');
                filterOption.value = category;
                filterOption.textContent = category;
                filterCategorySelect.appendChild(filterOption);
                
                // Ø¹Ø±Ø¶ Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª ÙƒØ¹Ù„Ø§Ù…Ø§Øª
                const tag = document.createElement('div');
                tag.className = 'category-tag';
                tag.innerHTML = `
                    ${category}
                    <button class="category-tag-remove" onclick="removeCategory('${category}')">Ã—</button>
                `;
                categoriesListDiv.appendChild(tag);
            });
            
            // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª Ù„Ù„Ø¯Ø®Ù„
            const incomeCategories = ["Ø±ÙˆØ§ØªØ¨", "Ø§Ø³ØªØ«Ù…Ø§Ø±", "Ø£Ø®Ø±Ù‰"];
            incomeCategories.forEach(cat => {
                if (!categories.includes(cat)) {
                    const option = document.createElement('option');
                    option.value = cat;
                    option.textContent = cat;
                    categorySelect.appendChild(option);
                }
            });
        }

        // Ø¥Ø¶Ø§ÙØ© ØªØµÙ†ÙŠÙ Ø¬Ø¯ÙŠØ¯
        async function addNewCategory(categoryName) {
            if (!categoryName || categoryName.trim() === '') {
                showNotification("ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… ØªØµÙ†ÙŠÙ");
                return;
            }
            
            const trimmedCategory = categoryName.trim();
            
            if (categories.includes(trimmedCategory)) {
                showNotification("Ù‡Ø°Ø§ Ø§Ù„ØªØµÙ†ÙŠÙ Ù…ÙˆØ¬ÙˆØ¯ Ù…Ø³Ø¨Ù‚Ø§Ù‹");
                return;
            }
            
            categories.push(trimmedCategory);
            await saveCategories();
            updateCategoriesUI();
            showNotification(`ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªØµÙ†ÙŠÙ "${trimmedCategory}"`);
            
            // ØªÙØ±ÙŠØº Ø­Ù‚Ù„ Ø§Ù„ØªØµÙ†ÙŠÙ Ø§Ù„Ø¬Ø¯ÙŠØ¯
            document.getElementById('newCategoryInput').value = '';
        }

        // Ø­Ø°Ù ØªØµÙ†ÙŠÙ
        async function removeCategory(categoryName) {
            if (!confirm(`Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ø§Ù„ØªØµÙ†ÙŠÙ "${categoryName}"ØŸ\n\nÙ…Ù„Ø§Ø­Ø¸Ø©: Ø³ÙŠØªÙ… ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø°Ø§Øª Ù‡Ø°Ø§ Ø§Ù„ØªØµÙ†ÙŠÙ Ø¥Ù„Ù‰ "Ø£Ø®Ø±Ù‰".`)) {
                return;
            }
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ø§Ù„ØªÙŠ ØªØ³ØªØ®Ø¯Ù… Ù‡Ø°Ø§ Ø§Ù„ØªØµÙ†ÙŠÙ
            records.forEach(record => {
                if (record.category === categoryName) {
                    record.category = "Ø£Ø®Ø±Ù‰";
                }
            });
            
            // Ø­Ø°Ù Ø§Ù„ØªØµÙ†ÙŠÙ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
            const index = categories.indexOf(categoryName);
            if (index > -1) {
                categories.splice(index, 1);
            }
            
            await saveCategories();
            await saveRecords();
            updateCategoriesUI();
            updateSummary();
            updateRecordsList();
            showNotification(`ØªÙ… Ø­Ø°Ù Ø§Ù„ØªØµÙ†ÙŠÙ "${categoryName}" ÙˆØªØ­ÙˆÙŠÙ„ Ø¹Ù…Ù„ÙŠØ§ØªÙ‡ Ø¥Ù„Ù‰ "Ø£Ø®Ø±Ù‰"`);
        }

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù„Ø®Øµ
        function updateSummary() {
            let income = 0, expense = 0;
            
            records.forEach(r => {
                if (r.type === "income") income += r.amount;
                else expense += r.amount;
            });
            
            document.getElementById("income").innerText = income.toFixed(2);
            document.getElementById("expense").innerText = expense.toFixed(2);
            document.getElementById("balance").innerText = (income - expense).toFixed(2);
            
            // ØªØ­Ø¯ÙŠØ« Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ø±ØµÙŠØ¯
            const balanceElement = document.getElementById("balance");
            const balance = income - expense;
            balanceElement.className = "amount balance-amount";
            if (balance > 0) {
                balanceElement.style.color = "#38a169";
            } else if (balance < 0) {
                balanceElement.style.color = "#e53e3e";
            } else {
                balanceElement.style.color = "#4c51bf";
            }
        }

        // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ù…Ø¹ Ø§Ù„ØªØµÙÙŠØ©
        function updateRecordsList(filtered = false, filteredRecords = []) {
            const list = document.getElementById("recordsList");
            const recordsToShow = filtered ? filteredRecords : records;
            
            // Ù…Ø³Ø­ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
            list.innerHTML = "";
            
            if (recordsToShow.length === 0) {
                list.innerHTML = '<div class="empty-message">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù…Ù„ÙŠØ§Øª Ù…Ø³Ø¬Ù„Ø© Ø¨Ø¹Ø¯. Ø£Ø¶Ù Ø£ÙˆÙ„ Ø¹Ù…Ù„ÙŠØ©!</div>';
                return;
            }
            
            // Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ø¨ØªØ±ØªÙŠØ¨ Ø²Ù…Ù†ÙŠ Ù…Ù† Ø§Ù„Ø£Ø­Ø¯Ø« Ù„Ù„Ø£Ù‚Ø¯Ù…
            recordsToShow.sort((a, b) => new Date(b.date) - new Date(a.date));
            
            recordsToShow.forEach((r, index) => {
                const li = document.createElement("div");
                li.className = "record-item";
                
                const date = new Date(r.date);
                const dateStr = date.toLocaleDateString('ar-SA', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
                
                li.innerHTML = `
                    <div class="record-info">
                        <div class="record-header">
                            <span class="${r.type === "income" ? "type-income" : "type-expense"}">
                                ${r.type === "income" ? "Ø¯Ø®Ù„" : "Ù…ØµØ±ÙˆÙ"}
                            </span>
                            <span class="record-category">${r.category}</span>
                        </div>
                        <span class="record-date">${dateStr}</span>
                    </div>
                    <div class="record-actions">
                        <span class="record-amount ${r.type === "income" ? "record-income" : "record-expense"}">
                            ${r.amount.toFixed(2)}
                        </span>
                        <button class="btn-delete" onclick="deleteRecord(${index})" title="Ø­Ø°Ù">
                            ğŸ—‘ï¸
                        </button>
                    </div>
                `;
                
                list.appendChild(li);
            });
        }

        // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØµÙÙŠØ© Ø¹Ù„Ù‰ Ø§Ù„Ø³Ø¬Ù„Ø§Øª
        function applyFilter() {
            const dateFrom = document.getElementById('filterDateFrom').value;
            const dateTo = document.getElementById('filterDateTo').value;
            const category = document.getElementById('filterCategory').value;
            
            let filteredRecords = records;
            
            // ØªØµÙÙŠØ© Ø­Ø³Ø¨ Ø§Ù„ØªØ§Ø±ÙŠØ®
            if (dateFrom) {
                const fromDate = new Date(dateFrom);
                filteredRecords = filteredRecords.filter(r => new Date(r.date) >= fromDate);
            }
            
            if (dateTo) {
                const toDate = new Date(dateTo);
                toDate.setHours(23, 59, 59, 999);
                filteredRecords = filteredRecords.filter(r => new Date(r.date) <= toDate);
            }
            
            // ØªØµÙÙŠØ© Ø­Ø³Ø¨ Ø§Ù„ØªØµÙ†ÙŠÙ
            if (category !== 'all') {
                filteredRecords = filteredRecords.filter(r => r.category === category);
            }
            
            updateRecordsList(true, filteredRecords);
        }

        // Ø­Ø°Ù Ø¹Ù…Ù„ÙŠØ©
        async function deleteRecord(index) {
            if (confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©ØŸ")) {
                records.splice(index, 1);
                await saveRecords();
                updateSummary();
                updateRecordsList();
                showNotification("ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­");
            }
        }

        // Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„ÙŠØ¯ÙˆÙŠ
        document.getElementById("manualForm").addEventListener("submit", async function(e) {
            e.preventDefault();

            let amount = parseFloat(document.getElementById("amountInput").value);
            let type = document.getElementById("typeInput").value;
            let category = document.getElementById("categoryInput").value;
            let newCategory = document.getElementById("newCategoryInput").value.trim();
            
            // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ØªØµÙ†ÙŠÙ Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ø¥Ø°Ø§ ØªÙ… Ø¥Ø¯Ø®Ø§Ù„Ù‡
            if (newCategory) {
                category = newCategory;
                await addNewCategory(newCategory);
            }
            
            // Ù…ØµØ§Ø¯Ù‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª
            if (isNaN(amount) || amount <= 0) {
                alert("ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº ØµØ­ÙŠØ­ Ø£ÙƒØ¨Ø± Ù…Ù† Ø§Ù„ØµÙØ±");
                return;
            }
            
            if (!category) {
                category = "Ø£Ø®Ø±Ù‰";
            }
            
            // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø§Ù„ÙŠ
            const today = new Date().toISOString().split('T')[0];
            
            records.push({
                amount, 
                type, 
                category,
                date: today
            });
            
            await saveRecords();
            updateSummary();
            updateRecordsList();

            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø­Ù‚ÙˆÙ„
            document.getElementById("amountInput").value = "";
            document.getElementById("newCategoryInput").value = "";
            document.getElementById("amountInput").focus();
            
            showNotification(`ØªÙ… Ø¥Ø¶Ø§ÙØ© ${type === "income" ? "Ø¯Ø®Ù„" : "Ù…ØµØ±ÙˆÙ"} Ø¨Ù‚ÙŠÙ…Ø© ${amount.toFixed(2)} Ù„Ù„ØªØµÙ†ÙŠÙ ${category}`);
        });

        // ==================================
        // ØªØ­Ø³ÙŠÙ† Ø§Ù„ØªØ¹Ø±Ù Ø§Ù„ØµÙˆØªÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¨Ø§Ù„Øº
        // ==================================
        const arabicNumbersMap = {
            'ÙˆØ§Ø­Ø¯': 1, 'Ø§Ø­Ø¯': 1,
            'Ø§Ø«Ù†Ø§Ù†': 2, 'Ø§Ø«Ù†ÙŠÙ†': 2,
            'Ø«Ù„Ø§Ø«Ø©': 3, 'Ø«Ù„Ø§Ø«': 3,
            'Ø£Ø±Ø¨Ø¹Ø©': 4, 'Ø§Ø±Ø¨Ø¹Ø©': 4,
            'Ø®Ù…Ø³Ø©': 5, 'Ø®Ù…Ø³': 5,
            'Ø³ØªØ©': 6, 'Ø³Øª': 6,
            'Ø³Ø¨Ø¹Ø©': 7, 'Ø³Ø¨Ø¹': 7,
            'Ø«Ù…Ø§Ù†ÙŠØ©': 8, 'Ø«Ù…Ø§Ù†': 8,
            'ØªØ³Ø¹Ø©': 9, 'ØªØ³Ø¹': 9,
            'Ø¹Ø´Ø±Ø©': 10,
            'Ø£Ø­Ø¯ Ø¹Ø´Ø±': 11, 'Ø§Ø­Ø¯ Ø¹Ø´Ø±': 11,
            'Ø§Ø«Ù†Ø§ Ø¹Ø´Ø±': 12, 'Ø§Ø«Ù†ÙŠ Ø¹Ø´Ø±': 12,
            'Ø«Ù„Ø§Ø«Ø© Ø¹Ø´Ø±': 13, 'Ø«Ù„Ø§Ø« Ø¹Ø´Ø±': 13,
            'Ø£Ø±Ø¨Ø¹Ø© Ø¹Ø´Ø±': 14, 'Ø§Ø±Ø¨Ø¹Ø© Ø¹Ø´Ø±': 14,
            'Ø®Ù…Ø³Ø© Ø¹Ø´Ø±': 15, 'Ø®Ù…Ø³ Ø¹Ø´Ø±': 15,
            'Ø³ØªØ© Ø¹Ø´Ø±': 16, 'Ø³Øª Ø¹Ø´Ø±': 16,
            'Ø³Ø¨Ø¹Ø© Ø¹Ø´Ø±': 17, 'Ø³Ø¨Ø¹ Ø¹Ø´Ø±': 17,
            'Ø«Ù…Ø§Ù†ÙŠØ© Ø¹Ø´Ø±': 18, 'Ø«Ù…Ø§Ù† Ø¹Ø´Ø±': 18,
            'ØªØ³Ø¹Ø© Ø¹Ø´Ø±': 19, 'ØªØ³Ø¹ Ø¹Ø´Ø±': 19,
            'Ø¹Ø´Ø±ÙˆÙ†': 20, 'Ø¹Ø´Ø±ÙŠÙ†': 20,
            'Ø«Ù„Ø§Ø«ÙˆÙ†': 30, 'Ø«Ù„Ø§Ø«ÙŠÙ†': 30,
            'Ø£Ø±Ø¨Ø¹ÙˆÙ†': 40, 'Ø§Ø±Ø¨Ø¹ÙˆÙ†': 40, 'Ø£Ø±Ø¨Ø¹ÙŠÙ†': 40,
            'Ø®Ù…Ø³ÙˆÙ†': 50, 'Ø®Ù…Ø³ÙŠÙ†': 50,
            'Ø³ØªÙˆÙ†': 60, 'Ø³ØªÙŠÙ†': 60,
            'Ø³Ø¨Ø¹ÙˆÙ†': 70, 'Ø³Ø¨Ø¹ÙŠÙ†': 70,
            'Ø«Ù…Ø§Ù†ÙˆÙ†': 80, 'Ø«Ù…Ø§Ù†ÙŠÙ†': 80,
            'ØªØ³Ø¹ÙˆÙ†': 90, 'ØªØ³Ø¹ÙŠÙ†': 90,
            'Ù…Ø§Ø¦Ø©': 100, 'Ù…Ø¦Ø©': 100,
            'Ù…Ø¦ØªØ§Ù†': 200,
            'Ø«Ù„Ø§Ø«Ù…Ø§Ø¦Ø©': 300, 'Ø«Ù„Ø§Ø«Ù…Ø¦Ø©': 300,
            'Ø£Ø±Ø¨Ø¹Ù…Ø§Ø¦Ø©': 400, 'Ø§Ø±Ø¨Ø¹Ù…Ø§Ø¦Ø©': 400,
            'Ø®Ù…Ø³Ù…Ø§Ø¦Ø©': 500, 'Ø®Ù…Ø³Ù…Ø¦Ø©': 500,
            'Ø³ØªÙ…Ø§Ø¦Ø©': 600, 'Ø³ØªÙ…Ø¦Ø©': 600,
            'Ø³Ø¨Ø¹Ù…Ø§Ø¦Ø©': 700, 'Ø³Ø¨Ø¹Ù…Ø¦Ø©': 700,
            'Ø«Ù…Ø§Ù†Ù…Ø§Ø¦Ø©': 800, 'Ø«Ù…Ø§Ù†Ù…Ø¦Ø©': 800,
            'ØªØ³Ø¹Ù…Ø§Ø¦Ø©': 900, 'ØªØ³Ø¹Ù…Ø¦Ø©': 900
        };

        const multipliersMap = {
            'Ø£Ù„Ù': 1000, 'Ø§Ù„Ù': 1000,
            'Ø¢Ù„Ø§Ù': 1000,
            'Ù…Ù„ÙŠÙˆÙ†': 1000000,
            'Ù…Ù„Ø§ÙŠÙŠÙ†': 1000000,
            'Ù…Ù„ÙŠØ§Ø±': 1000000000,
            'Ù…Ù„ÙŠØ§Ø±Ø§Øª': 1000000000
        };

        function convertArabicWordsToNumber(text) {
            let total = 0;
            let current = 0;
            let lastMultiplier = 1;
            
            const words = text.split(' ');
            
            for (let word of words) {
                word = word.trim();
                
                // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª ÙƒÙ„Ù…Ø© Ù…Ø¶Ø§Ø¹Ù (Ø£Ù„ÙØŒ Ù…Ù„ÙŠÙˆÙ†ØŒ Ø¥Ù„Ø®)
                if (multipliersMap[word]) {
                    if (current === 0) current = 1;
                    total += current * multipliersMap[word];
                    current = 0;
                    lastMultiplier = multipliersMap[word];
                }
                // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø±Ù‚Ù… Ø¹Ø±Ø¨ÙŠ
                else if (arabicNumbersMap[word]) {
                    const num = arabicNumbersMap[word];
                    
                    // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø±Ù‚Ù… 100 Ø£Ùˆ Ø£ÙƒØ«Ø±
                    if (num >= 100) {
                        if (current === 0) current = 1;
                        current *= num;
                    } else {
                        current += num;
                    }
                }
                // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø£Ø±Ù‚Ø§Ù… Ø¹Ø±Ø¨ÙŠØ© (Ù -Ù©)
                else if (/[\u0660-\u0669]/.test(word)) {
                    // ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø¥Ù„Ù‰ Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©
                    let numStr = word.replace(/[\u0660-\u0669]/g, function(d) {
                        return String.fromCharCode(d.charCodeAt(0) - 0x0660 + 0x30);
                    });
                    const num = parseFloat(numStr);
                    if (!isNaN(num)) {
                        current = current * 10 + num;
                    }
                }
                // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø£Ø±Ù‚Ø§Ù… Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©
                else if (/\d/.test(word)) {
                    const num = parseFloat(word);
                    if (!isNaN(num)) {
                        current = num;
                    }
                }
            }
            
            // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¨Ø§Ù‚ÙŠ
            total += current;
            
            return total;
        }

        function extractAmountFromSpeech(text) {
            console.log("ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù†Øµ:", text);
            
            // Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù…Ø¨Ù„Øº Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… regex
            const amountRegex = /(\d+([,.]\d+)?)/g;
            const matches = text.match(amountRegex);
            
            let amount = 0;
            
            if (matches && matches.length > 0) {
                // Ø£Ø®Ø° Ø£ÙƒØ¨Ø± Ù…Ø¨Ù„Øº Ù…ÙˆØ¬ÙˆØ¯ (ÙÙŠ Ø­Ø§Ù„Ø© ÙˆØ¬ÙˆØ¯ Ø£ÙƒØ«Ø± Ù…Ù† ÙˆØ§Ø­Ø¯)
                amount = Math.max(...matches.map(m => parseFloat(m.replace(',', ''))));
                console.log("ØªÙ… Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù…Ø¨Ù„Øº Ø¨Ø§Ù„Ø£Ø±Ù‚Ø§Ù…:", amount);
            } else {
                // Ø¥Ø°Ø§ Ù„Ù… ØªÙˆØ¬Ø¯ Ø£Ø±Ù‚Ø§Ù…ØŒ Ø­Ø§ÙˆÙ„ ØªØ­ÙˆÙŠÙ„ Ø§Ù„ÙƒÙ„Ù…Ø§Øª
                amount = convertArabicWordsToNumber(text);
                console.log("ØªÙ… Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù…Ø¨Ù„Øº Ø¨Ø§Ù„ÙƒÙ„Ù…Ø§Øª:", amount);
                
                // Ø¥Ø°Ø§ ÙØ´Ù„ Ø§Ù„ØªØ­ÙˆÙŠÙ„ØŒ Ø­Ø§ÙˆÙ„ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø£Ø±Ù‚Ø§Ù… Ø¹Ø±Ø¨ÙŠØ©
                if (amount === 0) {
                    const arabicDigitsRegex = /[\u0660-\u0669]+(?:[.,][\u0660-\u0669]+)?/g;
                    const arabicMatches = text.match(arabicDigitsRegex);
                    
                    if (arabicMatches && arabicMatches.length > 0) {
                        const arabicNum = arabicMatches[0];
                        let englishNum = arabicNum.replace(/[\u0660-\u0669]/g, function(d) {
                            return String.fromCharCode(d.charCodeAt(0) - 0x0660 + 0x30);
                        }).replace(',', '.');
                        amount = parseFloat(englishNum);
                        console.log("ØªÙ… Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù…Ø¨Ù„Øº Ø¨Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©:", amount);
                    }
                }
            }
            
            // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù…Ø¶Ø§Ø¹ÙØ§Øª Ù…Ø«Ù„ "Ø¢Ù„Ø§Ù" Ø£Ùˆ "Ù…Ù„Ø§ÙŠÙŠÙ†"
            if (text.includes('Ø£Ù„Ù') || text.includes('Ø§Ù„Ù') || text.includes('Ø¢Ù„Ø§Ù')) {
                if (amount < 1000) {
                    amount *= 1000;
                }
            }
            if (text.includes('Ù…Ù„ÙŠÙˆÙ†') || text.includes('Ù…Ù„Ø§ÙŠÙŠÙ†')) {
                if (amount < 1000000) {
                    amount *= 1000000;
                }
            }
            
            return amount;
        }

        // ==================================
        // Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„ØµÙˆØªÙŠ Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©
        // ==================================
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        let recognition = null;
        
        if (SpeechRecognition) {
            recognition = new SpeechRecognition();
            recognition.lang = "ar-SA";
            recognition.interimResults = false;
            recognition.maxAlternatives = 1;
            recognition.continuous = false;

            document.getElementById("voiceBtn").onclick = () => {
                startVoiceRecognition();
            };

            recognition.onstart = () => {
                document.getElementById("voiceStatus").className = "voice-status voice-listening";
                document.getElementById("voiceBtn").disabled = true;
                document.getElementById("voiceBtn").innerHTML = '<span class="icon">ğŸ¤</span> Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹...';
            };

            recognition.onend = () => {
                document.getElementById("voiceStatus").className = "voice-status";
                document.getElementById("voiceBtn").disabled = false;
                document.getElementById("voiceBtn").innerHTML = '<span class="icon">ğŸ¤</span> Ø§Ø¶ØºØ· Ù„Ù„ØªØ­Ø¯Ø« ÙˆØ¥Ø¶Ø§ÙØ© Ø¹Ù…Ù„ÙŠØ©';
            };

            recognition.onresult = async (event) => {
                let speechText = event.results[0][0].transcript.toLowerCase();
                console.log("Ø§Ù„Ù†Øµ Ø§Ù„Ù…Ù‚Ø±ÙˆØ¡:", speechText);
                
                // ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù†Øµ Ù„Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù…Ø¨Ù„Øº
                let amount = extractAmountFromSpeech(speechText);
                
                if (!amount || amount <= 0) {
                    showNotification("Ù„Ù… Ø£ØªÙ…ÙƒÙ† Ù…Ù† Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¨Ù„Øº! Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.");
                    return;
                }
                
                // ØªØ­Ø¯ÙŠØ¯ Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©
                let type = speechText.includes("Ø¯Ø®Ù„") ? "income" : "expense";
                
                // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ØªØµÙ†ÙŠÙ
                let category = "Ø£Ø®Ø±Ù‰";
                
                // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† ØªØµÙ†ÙŠÙ Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ø§Ù„Ù†Øµ
                for (const cat of categories) {
                    if (speechText.includes(cat.toLowerCase())) {
                        category = cat;
                        break;
                    }
                }
                
                // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„ØªØµÙ†ÙŠÙ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©ØŒ Ø¥Ø¶Ø§ÙØªÙ‡
                if (category === "Ø£Ø®Ø±Ù‰") {
                    // Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ø³ØªØ®Ø±Ø§Ø¬ ØªØµÙ†ÙŠÙ Ø¬Ø¯ÙŠØ¯ Ù…Ù† Ø§Ù„Ù†Øµ
                    const excludedWords = ["Ø¯Ø®Ù„", "Ù…ØµØ±ÙˆÙ", "Ù…ØµØ§Ø±ÙŠÙ", "Ø±ÙŠØ§Ù„", "Ø±Ø³", "Ø£Ù„Ù", "Ø§Ù„Ù", "Ù…Ù„ÙŠÙˆÙ†", ...Object.keys(arabicNumbersMap)];
                    const words = speechText.split(' ');
                    for (let word of words) {
                        word = word.trim();
                        if (!excludedWords.includes(word) && 
                            !/\d/.test(word) && 
                            word.length > 2 &&
                            !arabicNumbersMap[word]) {
                            category = word;
                            await addNewCategory(word);
                            break;
                        }
                    }
                }
                
                // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø§Ù„ÙŠ
                const today = new Date().toISOString().split('T')[0];
                
                records.push({
                    amount, 
                    type, 
                    category,
                    date: today
                });
                
                await saveRecords();
                updateSummary();
                updateRecordsList();
                showNotification(`ØªÙ… Ø¥Ø¶Ø§ÙØ© ${type === "income" ? "Ø¯Ø®Ù„" : "Ù…ØµØ±ÙˆÙ"} Ø¨Ù‚ÙŠÙ…Ø© ${amount.toFixed(2)} Ù„Ù„ØªØµÙ†ÙŠÙ ${category}`);
            };
            
            recognition.onerror = (event) => {
                console.error("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ¹Ø±Ù Ø§Ù„ØµÙˆØªÙŠ:", event.error);
                showNotification("Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ¹Ø±Ù Ø§Ù„ØµÙˆØªÙŠ. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.");
            };
            
        } else {
            document.getElementById("voiceBtn").onclick = () => {
                alert("Ù…ØªØµÙØ­Ùƒ Ù„Ø§ ÙŠØ¯Ø¹Ù… Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„ØµÙˆØªÙŠ. Ø§Ø³ØªØ®Ø¯Ù… Chrome Ø£Ùˆ Kiwi Ø£Ùˆ Ù…ØªØµÙØ­ ÙŠØ¯Ø¹Ù… SpeechRecognition!");
            };
        }

        // Ø¨Ø¯Ø¡ Ø§Ù„ØªØ¹Ø±Ù Ø§Ù„ØµÙˆØªÙŠ
        function startVoiceRecognition() {
            if (!recognition) {
                alert("Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„ØµÙˆØªÙŠ ØºÙŠØ± Ù…ØªØ§Ø­ ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù…ØªØµÙØ­");
                return;
            }
            
            try {
                recognition.start();
            } catch (err) {
                console.error("Ø®Ø·Ø£ ÙÙŠ Ø¨Ø¯Ø¡ Ø§Ù„ØªØ¹Ø±Ù Ø§Ù„ØµÙˆØªÙŠ:", err);
                showNotification("Ø­Ø¯Ø« Ø®Ø·Ø£. ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø³Ù…Ø§Ø­ Ù„Ù„Ù…ÙˆÙ‚Ø¹ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…ÙŠÙƒØ±ÙˆÙÙˆÙ†");
            }
        }

        // Ø¥Ù†Ø´Ø§Ø¡ ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª Ø­Ø³Ø¨ Ø§Ù„ØªØµÙ†ÙŠÙ
        async function generateReport() {
            const dateFrom = document.getElementById('reportDateFrom').value;
            const dateTo = document.getElementById('reportDateTo').value;
            
            if (!dateFrom || !dateTo) {
                alert("ÙŠØ±Ø¬Ù‰ ØªØ­Ø¯ÙŠØ¯ ÙØªØ±Ø© Ø²Ù…Ù†ÙŠØ© ØµØ­ÙŠØ­Ø©");
                return;
            }
            
            const fromDate = new Date(dateFrom);
            const toDate = new Date(dateTo);
            toDate.setHours(23, 59, 59, 999);
            
            // Ø¹Ø±Ø¶ Ù…Ø¤Ø´Ø± Ø§Ù„ØªØ­Ù…ÙŠÙ„
            document.getElementById('reportLoading').classList.add('active');
            
            // ØªØ£Ø®ÙŠØ± Ø¨Ø³ÙŠØ· Ù„Ø¹Ø±Ø¶ Ù…Ø¤Ø´Ø± Ø§Ù„ØªØ­Ù…ÙŠÙ„
            setTimeout(() => {
                // ØªØµÙÙŠØ© Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ø­Ø³Ø¨ Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆÙ†ÙˆØ¹ Ø§Ù„Ù…ØµØ±ÙˆÙ ÙÙ‚Ø·
                let filteredRecords = records.filter(r => {
                    const recordDate = new Date(r.date);
                    return r.type === "expense" && recordDate >= fromDate && recordDate <= toDate;
                });
                
                // ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ø­Ø³Ø¨ Ø§Ù„ØªØµÙ†ÙŠÙ
                let categoriesMap = {};
                let totalAmount = 0;
                
                filteredRecords.forEach(record => {
                    if (!categoriesMap[record.category]) {
                        categoriesMap[record.category] = {
                            records: [],
                            total: 0
                        };
                    }
                    categoriesMap[record.category].records.push(record);
                    categoriesMap[record.category].total += record.amount;
                    totalAmount += record.amount;
                });
                
                // Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø±ÙŠØ±
                displayReport(categoriesMap, totalAmount, fromDate, toDate);
                
                // Ø¥Ø®ÙØ§Ø¡ Ù…Ø¤Ø´Ø± Ø§Ù„ØªØ­Ù…ÙŠÙ„
                document.getElementById('reportLoading').classList.remove('active');
            }, 500);
        }

        // Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø±ÙŠØ± ÙÙŠ Ø§Ù„Ø¬Ø¯ÙˆÙ„
        function displayReport(categoriesMap, totalAmount, fromDate, toDate) {
            const tableBody = document.getElementById('reportTableBody');
            const tableFooter = document.getElementById('reportTableFooter');
            const table = document.getElementById('reportTable');
            const noData = document.getElementById('reportNoData');
            const statsContainer = document.getElementById('reportStatistics');
            
            tableBody.innerHTML = '';
            
            if (Object.keys(categoriesMap).length === 0) {
                table.style.display = 'none';
                noData.style.display = 'block';
                noData.textContent = 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ØµØ±ÙˆÙØ§Øª ÙÙŠ Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©';
                statsContainer.style.display = 'none';
                return;
            }
            
            noData.style.display = 'none';
            table.style.display = 'table';
            statsContainer.style.display = 'grid';
            
            let rowCount = 0;
            
            // Ø¹Ø±Ø¶ ÙƒÙ„ ØªØµÙ†ÙŠÙ ÙˆØ³Ø¬Ù„Ø§ØªÙ‡
            Object.keys(categoriesMap).sort().forEach(category => {
                const categoryData = categoriesMap[category];
                
                // ØµÙ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ØªØµÙ†ÙŠÙ
                const categoryRow = document.createElement('tr');
                categoryRow.className = 'category-header';
                categoryRow.innerHTML = `
                    <td colspan="3">
                        <strong>${category}</strong> - Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${categoryData.total.toFixed(2)}
                    </td>
                `;
                tableBody.appendChild(categoryRow);
                rowCount++;
                
                // Ø¹Ø±Ø¶ ÙƒÙ„ Ø³Ø¬Ù„ ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„ØªØµÙ†ÙŠÙ
                categoryData.records.sort((a, b) => new Date(b.date) - new Date(a.date)).forEach(record => {
                    const recordDate = new Date(record.date);
                    const dateStr = recordDate.toLocaleDateString('ar-SA', {
                        year: 'numeric',
                        month: 'long',
                        day: 'numeric'
                    });
                    
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${category}</td>
                        <td>${record.amount.toFixed(2)}</td>
                        <td>${dateStr}</td>
                    `;
                    tableBody.appendChild(row);
                    rowCount++;
                });
            });
            
            // ØµÙ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ
            tableFooter.innerHTML = '';
            const totalRow = document.createElement('tr');
            totalRow.className = 'total-row';
            totalRow.innerHTML = `
                <td><strong>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙƒÙ„ÙŠ</strong></td>
                <td><strong>${totalAmount.toFixed(2)}</strong></td>
                <td>${fromDate.toLocaleDateString('ar-SA')} Ø¥Ù„Ù‰ ${toDate.toLocaleDateString('ar-SA')}</td>
            `;
            tableFooter.appendChild(totalRow);
            
            // Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
            const categoriesCount = Object.keys(categoriesMap).length;
            statsContainer.innerHTML = `
                <div class="stat-item">
                    <div class="stat-value">${categoriesCount}</div>
                    <div class="stat-label">Ø¹Ø¯Ø¯ Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">${rowCount - categoriesCount}</div>
                    <div class="stat-label">Ø¹Ø¯Ø¯ Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">${totalAmount.toFixed(2)}</div>
                    <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">${(totalAmount / (rowCount - categoriesCount) || 0).toFixed(2)}</div>
                    <div class="stat-label">Ù…ØªÙˆØ³Ø· Ø§Ù„Ù…ØµØ±ÙˆÙ</div>
                </div>
            `;
        }

        // Ø¥Ø¸Ù‡Ø§Ø± Ø¥Ø´Ø¹Ø§Ø±
        function showNotification(message) {
            const notification = document.createElement("div");
            notification.textContent = message;
            notification.style.cssText = `
                position: fixed;
                top: 15px;
                right: 15px;
                background: #38a169;
                color: white;
                padding: 10px 16px;
                border-radius: 7px;
                z-index: 1000;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                animation: slideIn 0.3s ease;
                font-family: 'Cairo', sans-serif;
                font-size: 0.85rem;
                max-width: 300px;
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = "slideOut 0.3s ease";
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        // Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ø£Ø²Ø±Ø§Ø±
        document.getElementById('filterBtn').addEventListener('click', applyFilter);
        
        document.getElementById('clearFilterBtn').addEventListener('click', function() {
            document.getElementById('filterDateFrom').value = '';
            document.getElementById('filterDateTo').value = '';
            document.getElementById('filterCategory').value = 'all';
            updateRecordsList();
        });
        
        document.getElementById('generateReportBtn').addEventListener('click', generateReport);
        
        document.getElementById('clearReportBtn').addEventListener('click', function() {
            document.getElementById('reportTableBody').innerHTML = '';
            document.getElementById('reportTableFooter').innerHTML = '';
            document.getElementById('reportTable').style.display = 'none';
            document.getElementById('reportNoData').style.display = 'block';
            document.getElementById('reportNoData').textContent = 'Ù‚Ù… Ø¨ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ø²Ù…Ù†ÙŠØ© ÙˆØ¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªÙ‚Ø±ÙŠØ±';
            document.getElementById('reportStatistics').style.display = 'none';
        });
        
        document.getElementById('addCategoryBtn').addEventListener('click', async function() {
            const newCategory = document.getElementById('newCategoryInput').value.trim();
            await addNewCategory(newCategory);
        });
        
        // Ø¥Ø¶Ø§ÙØ© ØªØµÙ†ÙŠÙ Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Enter ÙÙŠ Ø­Ù‚Ù„ Ø§Ù„ØªØµÙ†ÙŠÙ Ø§Ù„Ø¬Ø¯ÙŠØ¯
        document.getElementById('newCategoryInput').addEventListener('keypress', async function(e) {
            if (e.key === 'Enter') {
                e.preventDefault();
                const newCategory = this.value.trim();
                await addNewCategory(newCategory);
            }
        });

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ù†Ø¯ Ø¨Ø¯Ø¡ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        loadData();
        
        // Ø¥Ø¶Ø§ÙØ© Ø£Ù†ÙŠÙ…ÙŠØ´Ù† Ù„Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>